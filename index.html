<html>
<head>
   <meta http-equiv='cache-control' content='no-cache'>
   <meta http-equiv='expires' content='0'>
   <meta http-equiv='pragma' content='no-cache'>
   <style>
      table, th, td {
         border: 1px solid black;
         border-collapse: collapse; 
      }
      td, th {
         padding: 10px;
      }
   </style>
</head>
<body>
   <h2>Convert JSON data into an HTML table using JavaScript</h2>
   <h3>Resulting Table:</h3>
   <div id="container"></div>
   <script>
      // Function to convert JSON data to HTML table
      function convert() {
         // Sample JSON data URL
         var ts = new Date().getTime()
         url='https://raw.githubusercontent.com/AmazeAlgos/Options-Data/main/NIFTY_option_chain.json';
         // url += /\?/.test(url) ? "&" : "?";
         // url += "_=" + ts;
         // let jsonDataUrl = 'https://raw.githubusercontent.com/AmazeAlgos/Options-Data/main/tele_order.json';
         // let jsonDataUrl = url
         
         // Get the container element where the table will be inserted
         let container = document.getElementById("container");

         // Fetch JSON data from the URL
         fetch(url)
            .then(response => response.json())
            .then(jsonData => {
               // Create the table element
               let table = document.createElement("table");

               // Get the keys (column names) of the first object in the JSON data
               let cols = Object.keys(jsonData[0]);

               // Create the header element
               let thead = document.createElement("thead");
               let tr = document.createElement("tr");

               // Loop through the column names and create header cells
               cols.forEach((item) => {
                  let th = document.createElement("th");
                  th.innerText = item; // Set the column name as the text of the header cell
                  tr.appendChild(th); // Append the header cell to the header row
               });
               thead.appendChild(tr); // Append the header row to the header
               table.appendChild(thead); // Append the header to the table

               // Loop through the JSON data and create table rows
               jsonData.forEach((item) => {
                  let tr = document.createElement("tr");

                  // Get the values of the current object in the JSON data
                  let vals = Object.values(item);

                  // Loop through the values and create table cells
                  vals.forEach((elem) => {
                     let td = document.createElement("td");
                     td.innerText = elem; // Set the value as the text of the table cell
                     tr.appendChild(td); // Append the table cell to the table row
                  });
                  table.appendChild(tr); // Append the table row to the table
               });
               container.innerHTML = ''; // Clear the container
               container.appendChild(table); // Append the table to the container element
            })
            .catch(error => console.log('Error fetching JSON data:', error));
      }

      // Load JSON data and refresh every 30 seconds
      convert(); // Load JSON data initially
      setInterval(convert, 4000); // Refresh JSON data every 30 seconds
   </script>
</body>
</html>
